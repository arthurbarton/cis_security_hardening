# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

#### Public Classes

* [`cis_security_hardening`](#cis_security_hardening): Security baseline enforcement
* [`cis_security_hardening::config`](#cis_security_hardeningconfig): Configure the module
* [`cis_security_hardening::services`](#cis_security_hardeningservices): Services
* [`cis_security_hardening::sticky_world_writable_cron`](#cis_security_hardeningsticky_world_writable_cron): Create cron job for searching world writable dir3ctories with sticky bit

#### Private Classes

* `cis_security_hardening::rules::aide_installed`: Ensure AIDE is installed (Automated)
* `cis_security_hardening::rules::aide_regular_checks`: Ensure filesystem integrity is regularly checked (Automated)
* `cis_security_hardening::rules::apparmor`: Ensure AppArmor is installed (Automated)
* `cis_security_hardening::rules::apparmor_bootloader`: Ensure AppArmor is enabled in the bootloader configuration (Automated)
* `cis_security_hardening::rules::apparmor_profiles`: Ensure all AppArmor Profiles are enforcing (Automated)
* `cis_security_hardening::rules::apparmor_profiles_enforcing`: Ensure all AppArmor Profiles are in enforce or complain mode (Automated)
* `cis_security_hardening::rules::at_restrict`: Ensure at is restricted to authorized users (Automated)
* `cis_security_hardening::rules::auditd_access`: Ensure unsuccessful unauthorized file access attempts are collected (Automated)
* `cis_security_hardening::rules::auditd_actions`: Ensure system administrator actions (sudolog) are collected (Automated)
* `cis_security_hardening::rules::auditd_backlog_limit`: Ensure audit_backlog_limit is sufficient (Automated)
* `cis_security_hardening::rules::auditd_delete`: Ensure file deletion events by users are collected (Automated)
* `cis_security_hardening::rules::auditd_identity`: Ensure events that modify user/group information are collected (Automated)
* `cis_security_hardening::rules::auditd_immutable`: Ensure the audit configuration is immutable (Automated)
* `cis_security_hardening::rules::auditd_init`: Initialize auditd rules file
* `cis_security_hardening::rules::auditd_logins`: Ensure login and logout events are collected (Automated)
* `cis_security_hardening::rules::auditd_mac_policy`: Ensure events that modify the system's Mandatory Access Controls are collected (Automated)
* `cis_security_hardening::rules::auditd_max_log_file`: Ensure audit log storage size is configured (Manual)
* `cis_security_hardening::rules::auditd_max_log_file_action`: Ensure audit logs are not automatically deleted (Automated)
* `cis_security_hardening::rules::auditd_modules`: Ensure kernel module loading and unloading is collected (Automated)
* `cis_security_hardening::rules::auditd_mounts`: Ensure successful file system mounts are collected (Automated)
* `cis_security_hardening::rules::auditd_package`: Ensure auditd is installed (Automated)
* `cis_security_hardening::rules::auditd_perm_mod`: Ensure discretionary access control permission modification events are collected (Automated)
* `cis_security_hardening::rules::auditd_privileged_commands`: Ensure use of privileged commands is collected (Automated)
* `cis_security_hardening::rules::auditd_process`: Ensure auditing for processes that start prior to auditd is enabled (Automated)
* `cis_security_hardening::rules::auditd_scope`: Ensure changes to system administration scope (sudoers) is collected (Automated)
* `cis_security_hardening::rules::auditd_service`: Ensure auditd service is enabled (Automated).
* `cis_security_hardening::rules::auditd_session_logins`: Ensure session initiation information is collected (Automated)
* `cis_security_hardening::rules::auditd_system_locale`: Ensure events that modify the system's network environment are collected (Automated)
* `cis_security_hardening::rules::auditd_time_change`: Ensure events that modify date and time information are collected (Automated)
* `cis_security_hardening::rules::auditd_when_disk_full`: Ensure system is disabled when audit logs are full (Automated)
* `cis_security_hardening::rules::authselect_profile`: Create custom authselect profile (Scored)
* `cis_security_hardening::rules::authselect_profile_select`: Select authselect profile (Scored)
* `cis_security_hardening::rules::authselect_with_faillock`: Ensure authselect includes with-faillock (Scored)
* `cis_security_hardening::rules::avahi`: Ensure Avahi Server is not enabled (Automated)
* `cis_security_hardening::rules::bind`: Ensure DNS Server is not installed (Automated)
* `cis_security_hardening::rules::chrony`: Ensure chrony is configured (Automated)
* `cis_security_hardening::rules::cramfs`: Ensure mounting of cramfs filesystems is disabled (Automated)
* `cis_security_hardening::rules::cron_daily`: Ensure permissions on /etc/cron.daily are configured (Automated)
* `cis_security_hardening::rules::cron_hourly`: Ensure permissions on /etc/cron.hourly are configured (Automated)
* `cis_security_hardening::rules::cron_monthly`: Ensure permissions on /etc/cron.monthly are configured (Automated)
* `cis_security_hardening::rules::cron_restrict`: Ensure cron is restricted to authorized users (Automated)
* `cis_security_hardening::rules::cron_weekly`: Ensure permissions on /etc/cron.weekly are configured (Automated)
* `cis_security_hardening::rules::crond_service`: Ensure cron daemon is enabled and running (Automated)
* `cis_security_hardening::rules::crontab`: Ensure permissions on /etc/crontab are configured (Automated)
* `cis_security_hardening::rules::crypto_policy`: Ensure system-wide crypto policy is FUTURE or FIPS (Scored)
* `cis_security_hardening::rules::cups`: Ensure CUPS is not enabled (Automated)
* `cis_security_hardening::rules::dev_shm`: Ensure /dev/shm is configured (Automated)
* `cis_security_hardening::rules::dev_shm_nodev`: Ensure nodev option set on /dev/shm partition (Automated)
* `cis_security_hardening::rules::dev_shm_noexec`: Ensure noexec option set on /dev/shm partition (Automated)
* `cis_security_hardening::rules::dev_shm_nosuid`: Ensure nosuid option set on /dev/shm partition (Automated)
* `cis_security_hardening::rules::dhcp`: Ensure DHCP Server is not enabled (Automated)
* `cis_security_hardening::rules::disable_automount`: Disable Automounting (Automated)
* `cis_security_hardening::rules::disable_dccp`: Ensure DCCP is disabled (Manual)
* `cis_security_hardening::rules::disable_ip_forwarding`: Ensure IP forwarding is disabled (Automated)
* `cis_security_hardening::rules::disable_ipv6`: Disable IPv6 (Manual)
* `cis_security_hardening::rules::disable_packet_redirect`: Ensure packet redirect sending is disabled (Automated)
* `cis_security_hardening::rules::disable_prelink`: Ensure prelink is disabled (Automated)
* `cis_security_hardening::rules::disable_rds`: Ensure RDS is disabled (Manual)
* `cis_security_hardening::rules::disable_sctp`: Ensure SCTP is disabled (Manual)
* `cis_security_hardening::rules::disable_tipc`: Ensure TIPC is disabled (Manual)
* `cis_security_hardening::rules::disable_usb_storage`: Disable USB Storage (Automated)
* `cis_security_hardening::rules::disable_wireless`: Ensure wireless interfaces are disabled (Not Scored)
* `cis_security_hardening::rules::dovecot`: Ensure IMAP and POP3 server is not enabled (Automated)
* `cis_security_hardening::rules::enable_aslr`: Ensure address space layout randomization (ASLR) is enabled (Automated)
* `cis_security_hardening::rules::enable_reverse_path_filtering`: Ensure Reverse Path Filtering is enabled (Automated)
* `cis_security_hardening::rules::enable_tcp_syn_cookies`: Ensure TCP SYN Cookies is enabled (Automated)
* `cis_security_hardening::rules::etc_crond`: Ensure permissions on /etc/cron.d are configured (Automated)
* `cis_security_hardening::rules::fat`: Ensure mounting of FAT filesystems is disabled (Automated)
* `cis_security_hardening::rules::firewalld_default_zone`: Ensure default zone is set (Automated)
* `cis_security_hardening::rules::firewalld_install`: Ensure a Firewall package is installed (Automated)
* `cis_security_hardening::rules::firewalld_interfaces`: Ensure network interfaces are assigned to appropriate zone (Manual)
* `cis_security_hardening::rules::firewalld_ports_services`: Ensure unnecessary services and ports are not accepted (Manual)
* `cis_security_hardening::rules::firewalld_service`: Ensure firewalld service is enabled and running (Automated)
* `cis_security_hardening::rules::freevxfs`: Ensure mounting of freevxfs filesystems is disabled (Automated)
* `cis_security_hardening::rules::gnome_gdm`
* `cis_security_hardening::rules::gnome_gdm_package`: Ensure GNOME Display Manager is removed (Manual)
* `cis_security_hardening::rules::group_bak_perms`: Ensure permissions on /etc/group- are configured (Automated)
* `cis_security_hardening::rules::group_perms`: Ensure permissions on /etc/group are configured (Automated)
* `cis_security_hardening::rules::grub_bootloader_config`: Ensure permissions on bootloader config are configured (Automated)
* `cis_security_hardening::rules::grub_password`: Ensure bootloader password is set (Automated)
* `cis_security_hardening::rules::gshadow_bak_perms`: Ensure permissions on /etc/gshadow- are configured (Automated)
* `cis_security_hardening::rules::gshadow_perms`: Ensure permissions on /etc/gshadow are configured (Automated)
* `cis_security_hardening::rules::hfs`: Ensure mounting of hfs filesystems is disabled (Automated)
* `cis_security_hardening::rules::hfsplus`: Ensure mounting of hfsplus filesystems is disabled (Automated)
* `cis_security_hardening::rules::home_nodev`: Ensure nodev option set on /home partition (Scored)
* `cis_security_hardening::rules::httpd`: Ensure HTTP server is not enabled (Automated)
* `cis_security_hardening::rules::icmp_redirects`: Ensure ICMP redirects are not accepted (Automated)
* `cis_security_hardening::rules::ignore_bogus_icmp_responses`: Ensure bogus ICMP responses are ignored (Automated)
* `cis_security_hardening::rules::ignore_icmp_broadcast`: Ensure broadcast ICMP requests are ignored (Automated)
* `cis_security_hardening::rules::ip6tables_deny_policy`: Ensure default deny firewall policy (Automated)
* `cis_security_hardening::rules::ip6tables_loopback`: Ensure loopback traffic is configured (Automated)
* `cis_security_hardening::rules::ip6tables_open_ports`: Ensure IPv6 firewall rules exist for all open ports (Manual)
* `cis_security_hardening::rules::ip6tables_outbound_established`: Ensure outbound and established connections are configured (Manual)
* `cis_security_hardening::rules::iptables_deny_policy`: Ensure default deny firewall policy (Automated)
* `cis_security_hardening::rules::iptables_install`: Ensure iptables is installed (Automated)
* `cis_security_hardening::rules::iptables_loopback`: Ensure loopback traffic is configured (Automated)
* `cis_security_hardening::rules::iptables_open_ports`: Ensure firewall rules exist for all open ports (Automated)
* `cis_security_hardening::rules::iptables_outbound_established`: Ensure outbound and established connections are configured (Manual)
* `cis_security_hardening::rules::ipv6_router_advertisements`: Ensure IPv6 router advertisements are not accepted (Manual)
* `cis_security_hardening::rules::issue_net_perms`: Ensure permissions on /etc/issue.net are configured (Manual)
* `cis_security_hardening::rules::issue_perms`: Ensure permissions on /etc/issue are configured (Automated)
* `cis_security_hardening::rules::jffs2`: Ensure mounting of jffs2 filesystems is disabled (Automated)
* `cis_security_hardening::rules::journald_compress`: Ensure journald is configured to compress large log files (Automated)
* `cis_security_hardening::rules::journald_persistent`: Ensure journald is configured to write logfiles to persistent disk (Automated)
* `cis_security_hardening::rules::journald_rsyslog`: Ensure journald is configured to send logs to rsyslog (Automated)
* `cis_security_hardening::rules::ldap_client`: Ensure LDAP client is not installed (Automated)
* `cis_security_hardening::rules::ldapd`: Ensure LDAP server is not enabled (Automated)
* `cis_security_hardening::rules::log_suspicious_packets`: Ensure suspicious packets are logged (Automated)
* `cis_security_hardening::rules::logfile_permissions`: Ensure permissions on all logfiles are configured (Automated)
* `cis_security_hardening::rules::logrotate`: Ensure logrotate is configured (Manual)
* `cis_security_hardening::rules::logrotate_configuration`: Ensure logrotate assigns appropriate permissions
* `cis_security_hardening::rules::mcstrans`: Ensure the MCS Translation Service (mcstrans) is not installed (Automated)
* `cis_security_hardening::rules::motd_perms`: Ensure message of the day is configured properly (Automated)
* `cis_security_hardening::rules::mta_local`: Ensure mail transfer agent is configured for local-only mode (Automated)
* `cis_security_hardening::rules::net_snmp`: Ensure net-snmp is not installed (Automated)
* `cis_security_hardening::rules::nfs`: Ensure NFS is not enabled (Automated)
* `cis_security_hardening::rules::nfs_utils`: Ensure nfs-utils is not installed or the nfs-server service is masked (Automated)
* `cis_security_hardening::rules::nftables_base_chains`: Ensure base chains exist (Automated)
* `cis_security_hardening::rules::nftables_default_deny`: Ensure default deny firewall policy (Automated)
* `cis_security_hardening::rules::nftables_flush_iptables`: Ensure iptables are flushed (Manual)
* `cis_security_hardening::rules::nftables_install`: Ensure nftables is installed (Automated)
* `cis_security_hardening::rules::nftables_loopback`: Ensure loopback traffic is configured (Automated)
* `cis_security_hardening::rules::nftables_outbound_established`: Ensure outbound and established connections are configured (Manual)
* `cis_security_hardening::rules::nftables_persistence`: Ensure nftables rules are permanent (Automated)
* `cis_security_hardening::rules::nftables_service`: Ensure nftables service is enabled (Automated)
* `cis_security_hardening::rules::nftables_table`: Ensure a table exists (Automated)
* `cis_security_hardening::rules::nis`: Ensure NIS Server is not enabled (Automated)
* `cis_security_hardening::rules::nis_client`: Ensure NIS Client is not installed (Automated)
* `cis_security_hardening::rules::ntp_package`: Install ntp package
* `cis_security_hardening::rules::ntpd`: Ensure ntp is configured (Automated)
* `cis_security_hardening::rules::pam_lockout`: Ensure lockout for failed password attempts is configured (Automated)
* `cis_security_hardening::rules::pam_old_passwords`: Ensure password reuse is limited (Automated)
* `cis_security_hardening::rules::pam_passwd_sha512`: Ensure password hashing algorithm is SHA-512 (Automated)
* `cis_security_hardening::rules::pam_pw_requirements`: Ensure password creation requirements are configured (Automated)
* `cis_security_hardening::rules::passwd_bak_perms`: Ensure permissions on /etc/group- are configured (Automated)
* `cis_security_hardening::rules::passwd_expiration`: Ensure password expiration is 365 days or less (Automated)
* `cis_security_hardening::rules::passwd_inactive_days`: Ensure inactive password lock is 30 days or less (Automated)
* `cis_security_hardening::rules::passwd_min_days`: Ensure minimum days between password changes is 7 or more (Automated)
* `cis_security_hardening::rules::passwd_perms`: Ensure permissions on /etc/passwd are configured (Automated)
* `cis_security_hardening::rules::passwd_warn_days`: Ensure password expiration warning days is 7 or more (Automated)
* `cis_security_hardening::rules::restrict_core_dumps`: A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean con
* `cis_security_hardening::rules::restrict_su`: Ensure access to the su command is restricted (Automated)
* `cis_security_hardening::rules::root_gid`: Ensure default group for the root account is GID 0 (Automated)
* `cis_security_hardening::rules::rpcbind`: Ensure rpcbind is not installed or the rpcbind services are masked (Automated)
* `cis_security_hardening::rules::rsh_client`: Ensure rsh client is not installed (Automated)
* `cis_security_hardening::rules::rsyncd`: Ensure rsync is not installed or the rsyncd service is masked (Automated)
* `cis_security_hardening::rules::rsyslog_default_file_perms`: Ensure rsyslog default file permissions configured (Automated)
* `cis_security_hardening::rules::rsyslog_installed`: Ensure rsyslog or syslog-ng is installed (Automated)
* `cis_security_hardening::rules::rsyslog_logging`: Ensure logging is configured (Manual)
* `cis_security_hardening::rules::rsyslog_remote_logs`: Ensure rsyslog is configured to send logs to a remote log host (Automated)
* `cis_security_hardening::rules::rsyslog_remote_syslog`: Ensure remote rsyslog messages are only accepted on designated log hosts. (Manual)
* `cis_security_hardening::rules::rsyslog_service`: Ensure rsyslog Service is enabled (Automated)
* `cis_security_hardening::rules::samba`: Ensure Samba is not installed (Automated)
* `cis_security_hardening::rules::secure_icmp_redirects`: Ensure secure ICMP redirects are not accepted (Automated)
* `cis_security_hardening::rules::selinux`: Ensure SELinux is installed (Automated)
* `cis_security_hardening::rules::selinux_bootloader`: Ensure SELinux is not disabled in bootloader configuration (Automated)
* `cis_security_hardening::rules::selinux_policy`: Ensure SELinux policy is configured (Automated)
* `cis_security_hardening::rules::selinux_state`: Ensure the SELinux state is enforcing or permissive (Automated)
* `cis_security_hardening::rules::setroubleshoot`: Ensure SETroubleshoot is not installed (Automated)
* `cis_security_hardening::rules::shadow_bak_perms`: Ensure permissions on /etc/shadow- are configured (Automated)
* `cis_security_hardening::rules::shadow_encrypt_sha512`: Ensure password hashing algorithm is SHA-512 (Automated)
* `cis_security_hardening::rules::shadow_perms`: Ensure permissions on /etc/shadow are configured (Automated)
* `cis_security_hardening::rules::shadowed_passwords`: Ensure accounts in /etc/passwd use shadowed passwords (Automated)
* `cis_security_hardening::rules::shell_nologin`: Ensure system accounts aresecured (Automated)
* `cis_security_hardening::rules::single_user_mode`: Ensure authentication required for single user mode (Automated)
* `cis_security_hardening::rules::source_routed_packets`: Ensure source routed packets are not accepted (Automated)
* `cis_security_hardening::rules::squashfs`: Ensure mounting of squashfs filesystems is disabled (Automated)
* `cis_security_hardening::rules::squid`: Ensure HTTP Proxy Server is not enabled (Automated)
* `cis_security_hardening::rules::sshd_banner`
* `cis_security_hardening::rules::sshd_ciphers`: Ensure only strong Ciphers are used (Automated)
* `cis_security_hardening::rules::sshd_config_permissions`: Ensure permissions on /etc/ssh/sshd_config are configured (Automated)
* `cis_security_hardening::rules::sshd_crypto_policy`: Ensure system-wide crypto policy is not over-ridden (Scored)
* `cis_security_hardening::rules::sshd_empty_passwords`: Ensure SSH PermitEmptyPasswords is disabled (Automated)
* `cis_security_hardening::rules::sshd_hostbased_authentication`: Ensure SSH HostbasedAuthentication is disabled (Automated)
* `cis_security_hardening::rules::sshd_ignore_rhosts`: Ensure SSH IgnoreRhosts is enabled (Automated)
* `cis_security_hardening::rules::sshd_kex`: Ensure only strong Key Exchange algorithms are used (Automated)
* `cis_security_hardening::rules::sshd_limit_access`: Ensure SSH access is limited (Automated)
* `cis_security_hardening::rules::sshd_login_gracetime`: Ensure SSH LoginGraceTime is set to one minute or less (Automated)
* `cis_security_hardening::rules::sshd_loglevel`: Ensure SSH LogLevel is set to INFO (Automated)
* `cis_security_hardening::rules::sshd_macs`: Ensure only approved MAC algorithms are used (Automated)
* `cis_security_hardening::rules::sshd_max_auth_tries`: Ensure SSH MaxAuthTries is set to 4 or less (Automated)
* `cis_security_hardening::rules::sshd_max_sessions`: Ensure SSH MaxSessions is set to 4 or less (Automated)
* `cis_security_hardening::rules::sshd_max_startups`: Ensure SSH MaxStartups is configured (Automated)
* `cis_security_hardening::rules::sshd_private_keys`: Ensure permissions on SSH private host key files are configured (Automated)
* `cis_security_hardening::rules::sshd_public_keys`: Ensure permissions on SSH public host key files are configured (Automated)
* `cis_security_hardening::rules::sshd_root_login`: Ensure SSH root login is disabled (Automated)
* `cis_security_hardening::rules::sshd_tcp_forwarding`: Ensure SSH AllowTcpForwarding is disabled (Automated)
* `cis_security_hardening::rules::sshd_timeouts`: Ensure SSH Idle Timeout Interval is configured (Automated)
* `cis_security_hardening::rules::sshd_use_pam`: Ensure SSH PAM is enabled (Automated)
* `cis_security_hardening::rules::sshd_user_environment`: Ensure SSH PermitUserEnvironment is disabled (Automated)
* `cis_security_hardening::rules::sshd_x11_forward`: Ensure SSH X11 forwarding is disabled (Automated)
* `cis_security_hardening::rules::sticky_world_writeable_files`: Ensure sticky bit is set on all world-writable directories (Automated)
* `cis_security_hardening::rules::sudo_installed`: Ensure sudo is installed (Automated)
* `cis_security_hardening::rules::sudo_log`: Ensure sudo log file exists (Automated)
* `cis_security_hardening::rules::sudo_use_pty`: Ensure sudo commands use pty (Automated)
* `cis_security_hardening::rules::systemd_timesyncd`: Ensure systemd-timesyncd is configured (Not Scored)
* `cis_security_hardening::rules::talk_client`: Ensure talk client is not installed (Automated)
* `cis_security_hardening::rules::telnet_client`: Ensure telnet client is not installed (Automated)
* `cis_security_hardening::rules::telnet_server`: Ensure telnet-server is not installed (Automated)
* `cis_security_hardening::rules::timeout_setting`: Ensure default user shell timeout is configured (Automated)
* `cis_security_hardening::rules::tmp_filesystem`: Ensure /tmp is configured (Automated)
* `cis_security_hardening::rules::tmp_nodev`: Ensure nodev option set on /tmp partition (Automated)
* `cis_security_hardening::rules::tmp_noexec`: Ensure noexec option set on /tmp partition (Automated)
* `cis_security_hardening::rules::tmp_nosuid`: Ensure nosuid option set on /tmp partition (Automated)
* `cis_security_hardening::rules::udf`: Ensure mounting of udf filesystems is disabled (Automated)
* `cis_security_hardening::rules::ufw_default_deny`: Ensure default deny firewall policy (Scored)
* `cis_security_hardening::rules::ufw_install`: Ensure ufw is installed (Automated)
* `cis_security_hardening::rules::ufw_loopback`: Ensure loopback traffic is configured (Automated)
* `cis_security_hardening::rules::ufw_open_ports`: Ensure firewall rules exist for all open ports (Manual)
* `cis_security_hardening::rules::ufw_outbound`: Ensure outbound connections are configured (Not Scored)
* `cis_security_hardening::rules::ufw_service`: Ensure ufw service is enabled (Automated)
* `cis_security_hardening::rules::umask_setting`: Ensure default user umask is configured (Automated)
* `cis_security_hardening::rules::var_tmp_nodev`: Ensure nodev option set on /var/tmp partition (Automated)
* `cis_security_hardening::rules::var_tmp_noexec`: Ensure noexec option set on /var/tmp partition (Automated)
* `cis_security_hardening::rules::var_tmp_nosuid`: Ensure nosuid option set on /var/tmp partition (Automated)
* `cis_security_hardening::rules::vsftp`: Ensure FTP Server is not enabled (Automated)
* `cis_security_hardening::rules::x11_installed`: Ensure X Window System is not installed (Automated)
* `cis_security_hardening::rules::xdmcp_config`: Ensure XDCMP is not enabled (Automated)
* `cis_security_hardening::rules::xinetd`: Ensure xinetd is not installed (Automated)
* `cis_security_hardening::rules::yum_gpgcheck`: Ensure gpgcheck is globally activated (Scored)
* `cis_security_hardening::rules::zypper_gpgcheck`: Ensure gpgcheck is globally activated (Automated)

### Defined types

* [`cis_security_hardening::set_mount_options`](#cis_security_hardeningset_mount_options): Change mount options
* [`cis_security_hardening::unmask_systemd_service`](#cis_security_hardeningunmask_systemd_service): Unmask a systemd service

### Functions

* [`sanitize_input`](#sanitize_input): sanitize_input.rb Uses Shellwords.escape to sabitize cmd.

### Data types

* [`Cis_security_hardening::Mountoption`](#cis_security_hardeningmountoption): Validate mountoption
* [`Cis_security_hardening::Mountpoint`](#cis_security_hardeningmountpoint): Validate mountpoint
* [`Cis_security_hardening::Numbers_letters`](#cis_security_hardeningnumbers_letters): Check for only numbers and letters
* [`Cis_security_hardening::Servicename`](#cis_security_hardeningservicename): Check service name
* [`Cis_security_hardening::Word`](#cis_security_hardeningword): Word datatype

### Tasks

* [`audit_sgid_executables`](#audit_sgid_executables): Audit SGID executables
* [`audit_suid_executables`](#audit_suid_executables): Audit SUID executables
* [`check_inactive_passwd_lock`](#check_inactive_passwd_lock): Check inactive password lock is 30 days or less.
* [`check_pass_max_days`](#check_pass_max_days): Check password expiration is 365 days or less.
* [`check_pass_min_days`](#check_pass_min_days): Check minimum days between password changes is configured.
* [`check_pass_warn_age`](#check_pass_warn_age): Check password expiration warning days is 7 or more.
* [`check_system_accounts_secured`](#check_system_accounts_secured): Check system accounts are secured.
* [`check_user_last_passwd_in_past`](#check_user_last_passwd_in_past): Check all users last password change date is in the past.
* [`cleanup_old_stuff`](#cleanup_old_stuff): Cleanup old files from (previous) cis module
* [`find_ungrouped_files_dirs`](#find_ungrouped_files_dirs): Find ungrouped files and directories.
* [`find_unowned_files_dirs`](#find_unowned_files_dirs): Find unowned files and directories.
* [`find_world_writable_files`](#find_world_writable_files): Find world writable files.
* [`fix_wrong_home_dir_permissions`](#fix_wrong_home_dir_permissions): Fix or report wrong home directory permissions

## Classes

### <a name="cis_security_hardening"></a>`cis_security_hardening`

Define a complete security baseline and monitor the rules. The definition of the baseline can be done in Hiera.
The purpose of the module is to give the ability to setup complete security baseline which not necessarily have to stick
to an industry security guide like the CIS benchmarks.

The easiest way to use the module is to put all rule data into a hiera file. For more information please coinsult the README file.

#### Examples

##### 

```puppet
include cis_security_hardening
```

#### Parameters

The following parameters are available in the `cis_security_hardening` class:

* [`profile`](#profile)
* [`level`](#level)
* [`update_postrun_command`](#update_postrun_command)
* [`fact_upload_command`](#fact_upload_command)
* [`exclude_dirs_sticky_ww`](#exclude_dirs_sticky_ww)
* [`auditd_suid_include`](#auditd_suid_include)
* [`auditd_suid_exclude`](#auditd_suid_exclude)
* [`auditd_rules_fact_file`](#auditd_rules_fact_file)
* [`time_until_reboot`](#time_until_reboot)
* [`verbose_logging`](#verbose_logging)

##### <a name="profile"></a>`profile`

Data type: `Enum['server']`

The benchmark profile to use. Currently only server profiles are supported.

Default value: `'server'`

##### <a name="level"></a>`level`

Data type: `Enum['1', '2']`

The CIS Benchmark server security level

Default value: `'2'`

##### <a name="update_postrun_command"></a>`update_postrun_command`

Data type: `Boolean`

Update Puppet agent post run command

Default value: ``true``

##### <a name="fact_upload_command"></a>`fact_upload_command`

Data type: `String`

Command to use to upload facts to Puppet master

Default value: `'/usr/share/cis_security_hardening/bin/fact_upload.sh'`

##### <a name="exclude_dirs_sticky_ww"></a>`exclude_dirs_sticky_ww`

Data type: `Array`

Araay of directories to exclude from the search for world writable directories with sticky bit

Default value: `[]`

##### <a name="auditd_suid_include"></a>`auditd_suid_include`

Data type: `Array`

Directories to search for suid and sgid programs. Can not be set together with auditd_suid_exclude

Default value: `['/usr']`

##### <a name="auditd_suid_exclude"></a>`auditd_suid_exclude`

Data type: `Array`

Directories to exclude from search for suid and sgid programs. Can not be set together with auditd_suid_include

Default value: `[]`

##### <a name="auditd_rules_fact_file"></a>`auditd_rules_fact_file`

Data type: `String`

The file where to store the facts for auditd rules

Default value: `'/opt/puppetlabs/facter/facts.d/cis_security_hardening_auditd.yaml'`

##### <a name="time_until_reboot"></a>`time_until_reboot`

Data type: `Integer`

Time to wait until system is rebooted if required. Time in seconds.

Default value: `120`

##### <a name="verbose_logging"></a>`verbose_logging`

Data type: `Boolean`

Print various info messages

Default value: ``false``

### <a name="cis_security_hardeningconfig"></a>`cis_security_hardening::config`

Create files, install scripts and cron jobs

#### Examples

##### 

```puppet
include cis_security_hardening::config
```

#### Parameters

The following parameters are available in the `cis_security_hardening::config` class:

* [`update_postrun_command`](#update_postrun_command)
* [`fact_upload_command`](#fact_upload_command)

##### <a name="update_postrun_command"></a>`update_postrun_command`

Data type: `Boolean`

Update Puppet agent's postrun command.

##### <a name="fact_upload_command"></a>`fact_upload_command`

Data type: `String`

Command to use for fact upload.

### <a name="cis_security_hardeningservices"></a>`cis_security_hardening::services`

Several exec resources needed from multiple classes.

#### Examples

##### 

```puppet
include cis_security_hardening::services
```

#### Parameters

The following parameters are available in the `cis_security_hardening::services` class:

* [`time_until_reboot`](#time_until_reboot)

##### <a name="time_until_reboot"></a>`time_until_reboot`

Data type: `Integer`

Time to wait until system is rebooted if required. Time in seconds.

Default value: `60`

### <a name="cis_security_hardeningsticky_world_writable_cron"></a>`cis_security_hardening::sticky_world_writable_cron`

Create a cron ob for the search for world writable directories with sticky bit set.

#### Examples

##### 

```puppet
include cis_security_hardening::sticky_world_writable_cron
```

#### Parameters

The following parameters are available in the `cis_security_hardening::sticky_world_writable_cron` class:

* [`dirs_to_exclude`](#dirs_to_exclude)
* [`filename`](#filename)
* [`script`](#script)

##### <a name="dirs_to_exclude"></a>`dirs_to_exclude`

Data type: `Array`

Array of directories to exclude from search.

Default value: `[]`

##### <a name="filename"></a>`filename`

Data type: `String`

The file to write data to

Default value: `'/usr/share/cis_security_hardening/data/world-writable-files.txt'`

##### <a name="script"></a>`script`

Data type: `String`

The script to run

Default value: `'/usr/share/cis_security_hardening/bin/sticy-world-writable.sh'`

## Defined types

### <a name="cis_security_hardeningset_mount_options"></a>`cis_security_hardening::set_mount_options`

Change the mount options of a mountpoint.

#### Examples

##### 

```puppet
cis_security_hardening::set_mount_options {
  mountpoint => '/home',
  mountoptions => 'nodev',
}
```

#### Parameters

The following parameters are available in the `cis_security_hardening::set_mount_options` defined type:

* [`mountpoint`](#mountpoint)
* [`mountoptions`](#mountoptions)

##### <a name="mountpoint"></a>`mountpoint`

Data type: `Cis_security_hardening::Mountpoint`

Mountpoint to work on

##### <a name="mountoptions"></a>`mountoptions`

Data type: `Cis_security_hardening::Mountoption`

Options to set

### <a name="cis_security_hardeningunmask_systemd_service"></a>`cis_security_hardening::unmask_systemd_service`

Execute a systemd command to unmask a service.

}

#### Examples

##### 

```puppet
cis_security_hardening::unmask_systemd_service { 'namevar':
    service => 'umask',
```

#### Parameters

The following parameters are available in the `cis_security_hardening::unmask_systemd_service` defined type:

* [`service`](#service)

##### <a name="service"></a>`service`

Data type: `Cis_security_hardening::Servicename`

The service to unmask

## Functions

### <a name="sanitize_input"></a>`sanitize_input`

Type: Ruby 4.x API

sanitize_input.rb
Uses Shellwords.escape to sabitize cmd.

#### `sanitize_input(String $cmd)`

sanitize_input.rb
Uses Shellwords.escape to sabitize cmd.

Returns: `String`

##### `cmd`

Data type: `String`



## Data types

### <a name="cis_security_hardeningmountoption"></a>`Cis_security_hardening::Mountoption`

Check a mount option

Alias of

```puppet
Pattern[/^[\/a-zA-Z0-9]+$/]
```

### <a name="cis_security_hardeningmountpoint"></a>`Cis_security_hardening::Mountpoint`

Check a mountpoint with a regex

Alias of

```puppet
Pattern[/^[\/a-zA-Z0-9_-]+$/]
```

### <a name="cis_security_hardeningnumbers_letters"></a>`Cis_security_hardening::Numbers_letters`

Check for only numbers and letters

Alias of

```puppet
Pattern[/^[0-9a-zA-Z]+$/, /^$/]
```

### <a name="cis_security_hardeningservicename"></a>`Cis_security_hardening::Servicename`

Check service name

Alias of

```puppet
Pattern[/^[a-zA-Z0-9\.\-_]+$/]
```

### <a name="cis_security_hardeningword"></a>`Cis_security_hardening::Word`

Word datatype

Alias of

```puppet
Pattern[/^[a-zA-Z0-9_]+$/]
```

## Tasks

### <a name="audit_sgid_executables"></a>`audit_sgid_executables`

Audit SGID executables

**Supports noop?** false

### <a name="audit_suid_executables"></a>`audit_suid_executables`

Audit SUID executables

**Supports noop?** false

### <a name="check_inactive_passwd_lock"></a>`check_inactive_passwd_lock`

Check inactive password lock is 30 days or less.

**Supports noop?** false

#### Parameters

##### `inactive`

Data type: `Integer`

Max. inactive days.

### <a name="check_pass_max_days"></a>`check_pass_max_days`

Check password expiration is 365 days or less.

**Supports noop?** false

### <a name="check_pass_min_days"></a>`check_pass_min_days`

Check minimum days between password changes is configured.

**Supports noop?** false

### <a name="check_pass_warn_age"></a>`check_pass_warn_age`

Check password expiration warning days is 7 or more.

**Supports noop?** false

### <a name="check_system_accounts_secured"></a>`check_system_accounts_secured`

Check system accounts are secured.

**Supports noop?** false

### <a name="check_user_last_passwd_in_past"></a>`check_user_last_passwd_in_past`

Check all users last password change date is in the past.

**Supports noop?** false

### <a name="cleanup_old_stuff"></a>`cleanup_old_stuff`

Cleanup old files from (previous) cis module

**Supports noop?** false

### <a name="find_ungrouped_files_dirs"></a>`find_ungrouped_files_dirs`

Find ungrouped files and directories.

**Supports noop?** false

### <a name="find_unowned_files_dirs"></a>`find_unowned_files_dirs`

Find unowned files and directories.

**Supports noop?** false

### <a name="find_world_writable_files"></a>`find_world_writable_files`

Find world writable files.

**Supports noop?** false

### <a name="fix_wrong_home_dir_permissions"></a>`fix_wrong_home_dir_permissions`

Fix or report wrong home directory permissions

**Supports noop?** false

#### Parameters

##### `fix`

Data type: `Enum[yes,no]`

Fix permissions or just report.

